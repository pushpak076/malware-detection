//pip install requests  this is to install for fetch api.

import requests

API_KEY = 'YOUR_VIRUSTOTAL_API_KEY'
API_URL = 'https://www.virustotal.com/vtapi/v2/file/report'

def check_file_malicious(file_hash):
    params = {
        'apikey': API_KEY,
        'resource': file_hash
    }
    response = requests.get(API_URL, params=params)

    if response.status_code == 200:
        result = response.json()
        if result['response_code'] == 1:
            if result['positives'] > 0:
                print(f'The file is malicious! Detected by {result["positives"]} out of {result["total"]} scanners.')
            else:
                print('The file is clean.')
        else:
            print('Invalid resource or resource not found on VirusTotal.')
    else:
        print('Error occurred during API call.')

# Example usage
file_hash = 'YOUR_FILE_SHA256_HASH'
check_file_malicious(file_hash)
