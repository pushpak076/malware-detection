; Include necessary headers
include windows.inc
include user32.inc
include kernel32.inc
include shell32.inc

; Declare necessary functions
includelib user32.lib
includelib kernel32.lib
includelib shell32.lib

; Define constants
MAX_PATH equ 260

; Define data section
.data
filename db MAX_PATH dup(?)
buffer db MAX_PATH dup(?)
message db "Press any key to exit.", 0

; Define code section
.code
start:
    ; Call GetModuleFileName function to get the full path of the current executable
    push NULL
    push offset filename
    push MAX_PATH
    call GetModuleFileNameA

    ; Call MessageBox function to display the full path of the current executable
    push NULL
    push offset filename
    push offset message
    push MB_OK
    call MessageBoxA

    ; Call GetCurrentDirectory function to get the current working directory
    push MAX_PATH
    push offset buffer
    call GetCurrentDirectoryA

    ; Call MessageBox function to display the current working directory
    push NULL
    push offset buffer
    push offset message
    push MB_OK
    call MessageBoxA

    ; Call ShellExecute function to open the current executable in Notepad
    push NULL
    push offset filename
    push offset "notepad.exe"
    push NULL
    push NULL
    push SW_SHOW
    call ShellExecuteA

    ; Call Sleep function to pause for 5 seconds
    push 5000
    call Sleep

    ; Call ExitProcess function to exit the program with a status of 0
    push 0
    call ExitProcess

end start
