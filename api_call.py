import re

with open("code2.asm", "r") as f:
    assembly_code = f.read()

api_call_pattern = re.compile(r"\s(call|jmp)\s+([A-Za-z0-9_$]+)[\s|\[]")


api_calls = set()
for match in api_call_pattern.findall(assembly_code):
    api_calls.add(match[1])


with open("api_calls.txt", "w") as f:

    for call in api_calls:
        f.write(call + "\n")
